# Requirements Document

## Introduction

This feature adds interactive mind map visualization capabilities to GrowMap's learning roadmap system. Users will be able to transform their AI-generated learning roadmaps into interactive, node-based visualizations using the Markmap library. This enhances the learning experience by providing a visual, hierarchical representation of learning paths that users can explore interactively.

## Glossary

- **GrowMap System**: The AI-powered learning roadmap generator application
- **Markmap Library**: A JavaScript library that converts markdown into interactive SVG-based mind maps using D3.js
- **Learning Roadmap**: A structured learning path generated by the GrowMap System containing topics, subtopics, resources, and learning milestones
- **Mind Map Visualization**: An interactive, hierarchical tree diagram rendered as SVG that displays the Learning Roadmap
- **Visual Map Button**: A UI control in the RoadmapView component that triggers the generation of the Mind Map Visualization
- **Markdown Content**: Hierarchically structured text using markdown syntax (headers and nested bullets)
- **HTML Response**: A complete HTML document containing embedded Markmap libraries (D3.js, markmap-lib, markmap-view) and the Mind Map Visualization
- **Backend Service**: The FastAPI server component of the GrowMap System
- **Frontend Component**: The React-based RoadmapView component of the GrowMap System
- **Blob URL**: A temporary browser URL created from HTML content for displaying in a new window

## Requirements

### Requirement 1

**User Story:** As a learner, I want to visualize my learning roadmap as an interactive mind map, so that I can better understand the hierarchical structure of my learning path and navigate through topics visually.

#### Acceptance Criteria

1. WHEN a user views a generated learning roadmap, THE GrowMap System SHALL display a "Visual Map" button in the RoadmapView component
2. WHEN the user clicks the "Visual Map" button, THE GrowMap System SHALL generate an interactive mind map visualization within 3 seconds
3. THE Mind Map Visualization SHALL display all topics and subtopics from the Learning Roadmap in a hierarchical tree structure
4. WHEN the Mind Map Visualization is generated, THE GrowMap System SHALL open the visualization in a new browser window
5. THE Mind Map Visualization SHALL support interactive node expansion and collapse through user clicks

### Requirement 2

**User Story:** As a learner, I want to interact with the mind map nodes, so that I can focus on specific areas of my learning roadmap and explore the content at my own pace.

#### Acceptance Criteria

1. WHEN a user clicks on a collapsed node in the Mind Map Visualization, THE GrowMap System SHALL expand that node to reveal its child nodes within 300 milliseconds
2. WHEN a user clicks on an expanded node in the Mind Map Visualization, THE GrowMap System SHALL collapse that node to hide its child nodes within 300 milliseconds
3. THE Mind Map Visualization SHALL display nodes with distinct colors based on their depth level in the hierarchy
4. THE Mind Map Visualization SHALL render text labels for each node with readable font size between 12px and 16px
5. WHEN the Mind Map Visualization loads, THE GrowMap System SHALL automatically expand nodes to level 2 depth by default

### Requirement 3

**User Story:** As a learner, I want control buttons in the mind map interface, so that I can quickly expand all nodes, collapse all nodes, or fit the entire map to my screen.

#### Acceptance Criteria

1. THE Mind Map Visualization SHALL display an "Expand All" button that expands all nodes when clicked
2. THE Mind Map Visualization SHALL display a "Collapse All" button that collapses all nodes except the root when clicked
3. THE Mind Map Visualization SHALL display a "Fit Screen" button that adjusts the zoom and position to show the entire map
4. WHEN a user clicks any control button, THE GrowMap System SHALL execute the corresponding action within 500 milliseconds
5. THE Mind Map Visualization SHALL position control buttons in a fixed location that remains visible during scrolling or zooming

### Requirement 4

**User Story:** As a learner, I want to download my mind map visualization, so that I can save it for offline viewing or share it with learning partners.

#### Acceptance Criteria

1. THE Mind Map Visualization SHALL display a "Download HTML" button in the interface
2. WHEN a user clicks the "Download HTML" button, THE GrowMap System SHALL generate a standalone HTML file containing the complete Mind Map Visualization
3. THE GrowMap System SHALL include the current date in the downloaded filename using the format "mindmap-YYYY-MM-DD.html"
4. THE downloaded HTML file SHALL function independently without requiring internet connectivity for the Markmap libraries
5. WHEN the download completes, THE GrowMap System SHALL save the file to the user's default downloads directory

### Requirement 5

**User Story:** As a developer, I want the backend to convert markdown study plans into Markmap-compatible HTML, so that the frontend can display interactive visualizations without client-side markdown processing.

#### Acceptance Criteria

1. THE Backend Service SHALL provide an API endpoint at "/api/generate-visual-roadmap" that accepts POST requests
2. WHEN the Backend Service receives a request with Markdown Content, THE Backend Service SHALL escape special characters for JavaScript embedding
3. THE Backend Service SHALL generate an HTML Response containing D3.js version 7.8.5, markmap-lib version 0.15.3, and markmap-view version 0.15.3 libraries
4. THE HTML Response SHALL include JavaScript code that initializes the Markmap library with the provided Markdown Content
5. THE Backend Service SHALL return the HTML Response with media type "text/html" and HTTP status code 200

### Requirement 6

**User Story:** As a developer, I want the frontend to trigger visualization generation and display the result, so that users can seamlessly transition from viewing text-based study plans to interactive mind maps.

#### Acceptance Criteria

1. THE Frontend Component SHALL send a POST request to "/api/generate-visual-roadmap" with the Study Roadmap markdown content
2. WHEN the Frontend Component receives the HTML Response, THE Frontend Component SHALL create a Blob object with type "text/html"
3. THE Frontend Component SHALL generate a temporary URL for the Blob object using URL.createObjectURL
4. THE Frontend Component SHALL open the temporary URL in a new browser window with dimensions of at least 1200x800 pixels
5. THE Frontend Component SHALL revoke the temporary URL within 2 seconds after opening the window to free memory

### Requirement 7

**User Story:** As a learner, I want the mind map to have a visually appealing dark theme, so that it matches GrowMap's interface and is comfortable to view during extended learning sessions.

#### Acceptance Criteria

1. THE Mind Map Visualization SHALL use a dark background color with hex value #0d1117 or similar
2. THE Mind Map Visualization SHALL render node text in light colors with sufficient contrast ratio of at least 4.5:1 against the background
3. THE Mind Map Visualization SHALL use a color palette of at least 5 distinct colors for nodes at different depth levels
4. THE Mind Map Visualization SHALL apply smooth color transitions between connected nodes
5. THE Mind Map Visualization SHALL use the Inter font family or a similar sans-serif font for all text elements

### Requirement 8

**User Story:** As a learner, I want the mind map to be responsive and performant, so that I can smoothly navigate large learning roadmaps without lag or visual glitches.

#### Acceptance Criteria

1. THE Mind Map Visualization SHALL render the initial view within 2 seconds for Learning Roadmaps containing up to 100 nodes
2. THE Mind Map Visualization SHALL complete node expansion or collapse animations within 300 milliseconds
3. THE Mind Map Visualization SHALL support smooth panning through mouse drag interactions
4. THE Mind Map Visualization SHALL support zoom in and zoom out through mouse wheel interactions
5. WHEN the Mind Map Visualization contains more than 50 nodes, THE GrowMap System SHALL limit the initial expansion to 2 levels to maintain performance
